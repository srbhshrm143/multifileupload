"use strict";(self.webpackChunkmarketplace_template_poc=self.webpackChunkmarketplace_template_poc||[]).push([[462],{131:function(S,b,i){i.r(b);var A=i(6403);const D=(r,a)=>{const e=r.target.parentNode;e.nextElementSibling&&(e.nextElementSibling.insertAdjacentElement("afterend",e),a(e))},U=(r,a)=>{const e=r.target.parentNode;e.previousElementSibling&&(e.previousElementSibling.insertAdjacentElement("beforebegin",e),a(e))};var _=(r,a)=>{const e=r.querySelectorAll('[role="presentation"] > .uppy-Dashboard-Item');for(let s of e){const p=document.createElement("div");p.appendChild(document.createTextNode("<<")),p.className="absolute top-1/2 left-0 bg-frame bg-opacity-50 p-2 cursor-pointer",p.addEventListener("click",h=>U(h,a)),s.appendChild(p);const l=document.createElement("div");l.appendChild(document.createTextNode(">>")),l.className="absolute top-1/2 right-0 bg-frame bg-opacity-50 p-2 cursor-pointer",l.addEventListener("click",h=>D(h,a)),s.appendChild(l)}},m=i(6928);const c=r=>{Alpine.store("variants").variants.forEach(e=>{const s=Alpine.raw(e);e.photos=s.photos.concat(r),e.photo_ids=e.photos.map(p=>p.id)})},d=r=>{Alpine.store("variants").variants.forEach(e=>{const s=Alpine.raw(e);e.photos=s.photos.filter(p=>p.id!=r.meta.photoId),e.photo_ids=e.photos.map(p=>p.id)})};api.setupPhotoUploadItemVariant=(r,a,e)=>{const s=Alpine.raw(a);s.photos||(s.photos=Alpine.raw(Alpine.store("main_variant").photos)||[]),s.photo_ids||(s.photo_ids=Alpine.raw(Alpine.store("main_variant").photo_ids)||[]),s.photos.sort((l,h)=>s.photo_ids.indexOf(l.id)-s.photo_ids.indexOf(h.id));const p=document.querySelector('[data-s3-uppy-photo="items"]');(0,A.Z)(p,r,s.photos).then(l=>{l.on("complete",({successful:y})=>{(0,m.Z)(l,p,y).then(g=>{a.photos=s.photos.concat(g),a.photo_ids=a.photos.map(u=>u.id),e&&c(g)})}),l.on("file-removed",(y,g)=>{g=="removed-by-user"&&(a.photos=s.photos.filter(u=>u.id!=y.meta.photoId),a.photo_ids=a.photos.map(u=>u.id),e&&d(y))});const h=y=>{const g=l.getFiles(),u=Array.from(y.parentNode.childNodes).map(v=>v.id.replace("uppy_","")),M=g.sort((v,o)=>u.indexOf(v.id)-u.indexOf(o.id));a.photo_ids=M.map(v=>v.meta.photoId)};_(document.querySelector(r),h)})},api.setupPhotoUploadItemVariant("#drag-drop-area",Alpine.store("main_variant"),!0)},6928:function(S,b,i){var A=i(4396);const D=_=>new Promise(m=>{let c=new FileReader,d={width:!1,height:!1};c.onload=function(){var r=new Image;r.onload=function(){d.width=r.width,d.height=r.height,m(d)},r.src=c.result},c.readAsDataURL(_)}),U=(_,m,c)=>{const d=_.dataset.s3UppyObjectUuid,r=_.dataset.s3UppyPhotoType;return D(c.data).then(a=>(0,A.Z)("/api/photos",{body:JSON.stringify({photo:{url:m,photo_type:r,object_uuid:d,photo_height:a.height,photo_width:a.width}})}))},I=(_,m,c)=>Promise.all(c.map(d=>U(m,d.response.body.location,d).then(r=>(_.setFileMeta(d.id,{photoId:r.id}),r))));b.Z=I},6403:function(S,b,i){var A=i(9046),D=i.n(A),U=i(2921),I=i.n(U),_=i(4222),m=i.n(_),c=i(5519),d=i.n(c),r=Object.defineProperty,a=Object.defineProperties,e=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,h=(o,n,t)=>n in o?r(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t,y=(o,n)=>{for(var t in n||(n={}))p.call(n,t)&&h(o,t,n[t]);if(s)for(var t of s(n))l.call(n,t)&&h(o,t,n[t]);return o},g=(o,n)=>a(o,e(n)),u=(o,n,t)=>new Promise((E,w)=>{var O=f=>{try{P(t.next(f))}catch(C){w(C)}},T=f=>{try{P(t.throw(f))}catch(C){w(C)}},P=f=>f.done?E(f.value):Promise.resolve(f.value).then(O,T);P((t=t.apply(o,n)).next())});const M=(o,n)=>u(void 0,null,function*(){for(let t=0;t<n.length;t++){const E=n[t],O=yield(yield fetch(E.photo.url)).blob();o.addFile({name:E.photo.file_name,type:O.type,data:O,meta:{photoId:E.id},remote:!0})}o.getFiles().forEach(t=>{o.setFileState(t.id,{progress:{uploadComplete:!0,percentage:100,uploadStarted:Date.now()}})})}),v=(o,n,t)=>u(void 0,null,function*(){const E=o.dataset.s3UppyMaxNumberOfFiles,w=o.dataset.s3UppyDisabled,O=o.dataset.s3UppyNote;t=t||JSON.parse(o.dataset.s3UppyPhotos||"[]")||[];const T=n||o.dataset.s3UppyTarget,P=new(D())({autoProceed:t.length==0,restrictions:{maxFileSize:2097152,maxNumberOfFiles:E,allowedFileTypes:["image/png","image/jpg","image/jpeg","image/webp"]}});return P.use(I(),{inline:!0,replaceTargetContent:!0,showProgressDetails:!0,target:T,note:O,width:"100%",height:300,proudlyDisplayPoweredByUppy:!1,showRemoveButtonAfterComplete:!w,hideCancelButton:w,hideUploadButton:w,doneButtonHandler:null,locale:{strings:{dropPasteImport:"Drag & drop, paste, or %{browse} to upload file",browse:"browse your computer"}}}).use(d(),{target:I(),modes:["picture"]}).use(m(),{getUploadParameters(){const f=o.getAttribute("action"),B=Array.from(new FormData(o)).reduce((R,F)=>g(y({},R),{[F[0]]:F[1]}),{});return Promise.resolve({method:"POST",url:f,fields:B})}}),document.addEventListener("photo-upload-reset",()=>{P.reset()}),yield M(P,t),P});b.Z=v}}]);
