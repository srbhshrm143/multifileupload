"use strict";(self.webpackChunkmarketplace_template_poc=self.webpackChunkmarketplace_template_poc||[]).push([[149],{4112:function(M,v,s){s.r(v);var f=s(6403),E=s(6928),h=(p,d,a)=>new Promise((r,n)=>{var m=l=>{try{y(a.next(l))}catch(w){n(w)}},g=l=>{try{y(a.throw(l))}catch(w){n(w)}},y=l=>l.done?r(l.value):Promise.resolve(l.value).then(m,g);y((a=a.apply(p,d)).next())});(p=>h(void 0,null,function*(){p.forEach(d=>h(this,null,function*(){const a=yield(0,f.Z)(d);a.on("complete",({successful:r})=>{(0,E.Z)(a,d,r).then(n=>{document.dispatchEvent(new CustomEvent("photos-added",{detail:{photos:n,preview:r[0].preview}}))})}),a.on("file-removed",(r,n)=>{n=="removed-by-user"&&document.dispatchEvent(new CustomEvent("photo-removed",{detail:{photoId:r.meta.photoId}}))})}))}))(document.querySelectorAll('[data-s3-uppy-photo="form"]'))},6928:function(M,v,s){var f=s(4396);const E=p=>new Promise(d=>{let a=new FileReader,r={width:!1,height:!1};a.onload=function(){var n=new Image;n.onload=function(){r.width=n.width,r.height=n.height,d(r)},n.src=a.result},a.readAsDataURL(p)}),h=(p,d,a)=>{const r=p.dataset.s3UppyObjectUuid,n=p.dataset.s3UppyPhotoType;return E(a.data).then(m=>(0,f.Z)("/api/photos",{body:JSON.stringify({photo:{url:d,photo_type:n,object_uuid:r,photo_height:m.height,photo_width:m.width}})}))},O=(p,d,a)=>Promise.all(a.map(r=>h(d,r.response.body.location,r).then(n=>(p.setFileMeta(r.id,{photoId:n.id}),n))));v.Z=O},6403:function(M,v,s){var f=s(9046),E=s.n(f),h=s(2921),O=s.n(h),p=s(4222),d=s.n(p),a=s(5519),r=s.n(a),n=Object.defineProperty,m=Object.defineProperties,g=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,b=(t,o,e)=>o in t?n(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,A=(t,o)=>{for(var e in o||(o={}))l.call(o,e)&&b(t,e,o[e]);if(y)for(var e of y(o))w.call(o,e)&&b(t,e,o[e]);return t},T=(t,o)=>m(t,g(o)),C=(t,o,e)=>new Promise((i,c)=>{var P=_=>{try{u(e.next(_))}catch(D){c(D)}},U=_=>{try{u(e.throw(_))}catch(D){c(D)}},u=_=>_.done?i(_.value):Promise.resolve(_.value).then(P,U);u((e=e.apply(t,o)).next())});const B=(t,o)=>C(void 0,null,function*(){for(let e=0;e<o.length;e++){const i=o[e],P=yield(yield fetch(i.photo.url)).blob();t.addFile({name:i.photo.file_name,type:P.type,data:P,meta:{photoId:i.id},remote:!0})}t.getFiles().forEach(e=>{t.setFileState(e.id,{progress:{uploadComplete:!0,percentage:100,uploadStarted:Date.now()}})})}),F=(t,o,e)=>C(void 0,null,function*(){const i=t.dataset.s3UppyMaxNumberOfFiles,c=t.dataset.s3UppyDisabled,P=t.dataset.s3UppyNote;e=e||JSON.parse(t.dataset.s3UppyPhotos||"[]")||[];const U=o||t.dataset.s3UppyTarget,u=new(E())({autoProceed:e.length==0,restrictions:{maxFileSize:2097152,maxNumberOfFiles:i,allowedFileTypes:["image/png","image/jpg","image/jpeg","image/webp"]}});return u.use(O(),{inline:!0,replaceTargetContent:!0,showProgressDetails:!0,target:U,note:P,width:"100%",height:300,proudlyDisplayPoweredByUppy:!1,showRemoveButtonAfterComplete:!c,hideCancelButton:c,hideUploadButton:c,doneButtonHandler:null,locale:{strings:{dropPasteImport:"Drag & drop, paste, or %{browse} to upload file",browse:"browse your computer"}}}).use(r(),{target:O(),modes:["picture"]}).use(d(),{getUploadParameters(){const _=t.getAttribute("action"),L=Array.from(new FormData(t)).reduce((R,I)=>T(A({},R),{[I[0]]:I[1]}),{});return Promise.resolve({method:"POST",url:_,fields:L})}}),document.addEventListener("photo-upload-reset",()=>{u.reset()}),yield B(u,e),u});v.Z=F}}]);
