"use strict";(self.webpackChunkmarketplace_template_poc=self.webpackChunkmarketplace_template_poc||[]).push([[255],{5566:function(j,P,p){p.r(P);var v=p(9046),f=p.n(v),E=p(2921),O=p.n(E),D=p(4222),h=p.n(D),i=p(4396),b=Object.defineProperty,w=Object.defineProperties,U=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,m=(e,o,t)=>o in e?b(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,T=(e,o)=>{for(var t in o||(o={}))g.call(o,t)&&m(e,t,o[t]);if(_)for(var t of _(o))M.call(o,t)&&m(e,t,o[t]);return e},C=(e,o)=>w(e,U(o)),A=(e,o,t)=>new Promise((r,d)=>{var c=a=>{try{s(t.next(a))}catch(n){d(n)}},l=a=>{try{s(t.throw(a))}catch(n){d(n)}},s=a=>a.done?r(a.value):Promise.resolve(a.value).then(c,l);s((t=t.apply(e,o)).next())});const B=(e,o)=>{const t=e.dataset.s3UppyObjectUuid,r=e.dataset.s3UppyType;return(0,i.Z)("/api/documents",{body:JSON.stringify({document:{direct_url:o,document_type:r,object_uuid:t}})})},I=e=>(0,i.Z)("/api/documents",{method:"DELETE",body:JSON.stringify({document:{id:e}})}),F=(e,o)=>A(void 0,null,function*(){for(let t=0;t<o.length;t++){const r=o[t],d=new Blob;e.addFile({name:r.file.file_name,type:d.type,source:r.file.url,data:d,meta:{objectId:r.id},remote:!0})}e.getFiles().forEach(t=>{e.setFileState(t.id,{progress:{uploadComplete:!0,percentage:100,uploadStarted:Date.now()}})})});document.querySelectorAll('[data-s3-uppy="document"]').forEach(e=>{const o=e.dataset.s3UppyMaxNumberOfFiles,t=e.dataset.s3UppyNote,r=e.dataset.s3UppyDisabled,d=JSON.parse(e.dataset.s3UppyDocuments||"[]")||[],c=e.dataset.s3UppyTarget;var l=["application/pdf"];e.dataset.s3UppyMediaTypes&&(l=e.dataset.s3UppyMediaTypes.split(","));const s=new(f())({autoProceed:d.length==0,restrictions:{maxFileSize:2097152,maxNumberOfFiles:o,allowedFileTypes:l}});s.use(O(),{inline:!0,replaceTargetContent:!0,showProgressDetails:!0,target:c,note:t,width:"100%",height:300,proudlyDisplayPoweredByUppy:!1,showRemoveButtonAfterComplete:!r,hideCancelButton:r,hideUploadButton:r,doneButtonHandler:null,locale:{strings:{dropPasteImport:"Drag & drop, paste, or %{browse} to upload file",browse:"browse your computer"}}}).use(h(),{getUploadParameters(){const a=e.getAttribute("action"),u=Array.from(new FormData(e)).reduce((S,y)=>C(T({},S),{[y[0]]:y[1]}),{});return Promise.resolve({method:"POST",url:a,fields:u})}}),s.on("complete",({successful:a})=>{Promise.all(a.map(n=>B(e,n.response.body.location).then(u=>(s.setFileMeta(n.id,{objectId:u.id}),u)))),document.dispatchEvent(new CustomEvent("upload-complete",{detail:a}))}),s.on("file-removed",(a,n)=>{n=="removed-by-user"&&I(a.meta.objectId),document.dispatchEvent(new CustomEvent("upload-removed"))}),F(s,d)})}}]);
